name: E2E testing
on: [push]
jobs:
  cypress-e2e:
    runs-on: ubuntu-latest
    steps:
      - name: ðŸ›Ž Checkout
        uses: actions/checkout@v2
      - name: ðŸ§ª Cypress run (Chrome)
        uses: cypress-io/github-action@v2
        with: 
          spec: cypress/integration/e2e/*
          browser: chrome
          record: true
          build: yarn build
          start: yarn start
          wait-on: 'http://localhost:3000'
          wait-on-timeout: 120
        env:
          REACT_APP_API_ENDPOINT: ${{ secrets.AZURE_API_ENDPOINT }}
          REACT_APP_API_VERSION: "v1"
          REACT_APP_ENV: "prod"
          REACT_APP_AUTH0_DOMAIN: ${{ secrets.AUTH0_DOMAIN }}
          REACT_APP_AUTH0_CLIENT_ID: ${{ secrets.AUTH0_CLIENT_ID }}
          REACT_APP_SELF_API_AUDIENCE: ${{ secrets.SELF_API_AUDIENCE }}
          REACT_APP_RECAPTCHA_CLIENT_KEY: ${{ secrets.RECAPTCHA_CLIENT_KEY }}
          REACT_APP_GA_TRACKING_ID: ${{ secrets.GA_TRACKING_ID }}
          CYPRESS_PROJECT_ID: ${{ secrets.CYPRESS_PROJECT_ID }}
          CYPRESS_RECORD_KEY: ${{ secrets.CYPRESS_RECORD_KEY }}
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}